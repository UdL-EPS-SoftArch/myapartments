<div *ngIf="isAuthorized" class="container mt-5 w-50 p-3">

  @if (isLoading) {
    <div class="d-flex justify-content-center align-items-center">
      <div class="spinner-border" role="status">
        <span class="sr-only">Loading...</span>
      </div>
    </div>
  }
  @else if (errorFetchMsg){
    <div class="alert alert-danger" role="alert">
      {{ errorFetchMsg }}
    </div>
  }
  @else {
      <h1 class="mb-4">Update Apartment</h1>


      <div class="mb-3">
        <label for="images" class="form-label">Images</label>
        <input type="file" class="form-control" id="images" (change)="onFileChange($event)" multiple>
        <div class="mt-3 d-flex flex-wrap">
          <div *ngFor="let image of selectedImages; let i = index" class="me-3 mb-3" style="position: relative; width: 100px; height: 100px; overflow: hidden; border: 1px solid #ccc; border-radius: 8px;">
            <img ngSrc="image.url" alt="Selected image" style="width: 100%; height: 100%; object-fit: cover;">
            <button type="button" (click)="removeImage(i)" style="position: absolute; top: 5px; right: 5px; background: dodgerblue; color: white; border: none; border-radius: 50%; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center; font-size: 16px; cursor: pointer;">
              Ã—
            </button>
          </div>
        </div>

      </div>

      <form (ngSubmit)="onSubmit()" [formGroup]="apartmentForm">
        <div class="mb-3">
          <label for="name" class="form-label">Name</label>
          <input type="text" formControlName="name" class="form-control" id="name" required [(ngModel)]="apartment.name" name="name">
        </div>

        <div class="mb-3">
          <label for="floor" class="form-label">Floor</label>
          <input type="number" formControlName="floor" class="form-control" id="floor" required [(ngModel)]="apartment.floor" name="floor">
        </div>

        <div class="mb-3">
          <label for="address" class="form-label">Address</label>
          <input type="text" formControlName="address" class="form-control" id="address" required [(ngModel)]="apartment.address" name="address">

        </div>

        <div class="mb-3">
          <label for="postalCode" class="form-label">Postal Code</label>
          <input type="text" formControlName="postalCode" class="form-control" id="postalCode" required [(ngModel)]="apartment.postalCode" name="postalCode">
        </div>

        <div class="mb-3">
          <label for="city" class="form-label">City</label>
          <input type="text" formControlName="city" class="form-control" id="city" required [(ngModel)]="apartment.city" name="city">
        </div>

        <div class="mb-3">
          <label for="country" class="form-label">Country</label>
          <input type="text" formControlName="country" class="form-control" id="country" required [(ngModel)]="apartment.country" name="country">
        </div>

        <div class="mb-3">
          <label for="description" class="form-label">Description</label>
          <textarea class="form-control" formControlName="description" id="description" rows="3" required [(ngModel)]="apartment.description" name="description" style="resize: vertical; min-height: 100px; max-height: 300px;"></textarea>
        </div>

        <div class="mb-3">
          <button [routerLink]="['/room/create']" type="button" class="btn btn-secondary">Add Room</button>
        </div>

        <div class="mb-3">
          <label for="detail" class="form-label">Apartment Details</label>
          <input type="text" class="form-control" id="detail" required [(ngModel)]="apartment.detail" name="detail">
        </div>

        <button type="submit" class="btn btn-primary mt-3">Submit</button>
        <button type="button" (click) = onCancel() class="btn btn-danger mt-3 fa-pull-right">Cancel</button>
      </form>



    <div *ngIf="!isAuthorized" class="container mt-5 w-50 p-3">
      <div class="alert alert-danger" role="alert">
        You are not authorized to create an apartment.
      </div>
    </div>

  }
</div>






